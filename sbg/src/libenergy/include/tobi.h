/*
 * tobi.h
 *
 * Implementation of the pairwise potential described in:
 * Designing coarse grained-and atom based-potentials for protein-protein docking.
 * Dror Tobi. BMC Structural Biology (2010).
 * DOI: 10.1186/1472-6807-10-40. Published: 15 November 2010
 *
 * This code was adapted from Pablo's implementation of TOBI energy found in Frodock.
 *
 *  Created on: Feb 8, 2017
 *      Author: mon
 */


#ifndef INCLUDE_TOBI_H_
#define INCLUDE_TOBI_H_

/*
Table 1. The designation of the 18 atom types 1

Atom type	Amino acid	Atom
N	BN	N
Cα	BN	CA
C	BN	C
O	BN	O
GCα	Gly	CA
Cβ	Ala	CB
 	Arg	CB
 	Asn	CB
 	Asp	CB
 	Cys	CB
 	Gln	CB
 	Glu	CB
 	His	CB
 	Ile	CB
 	Leu	CB
 	Lys	CB
 	Met	CB
 	Phe	CB
 	Pro	CB
 	Pro	CG
 	Pro	CD
 	Thr	CB
 	Trp	CB
 	Tyr	CB
 	Val	CB
KNξ	Lys	CE
 	Lys	NZ
KCδ	Lys	CD
DOδ	Asp	CG
 	Asp	OD1
 	Asp	OD2
 	Glu	CD
 	Glu	OE1
 	Glu	OE2
RNη	Arg	CZ
 	Arg	NH1
 	Arg	NH2
NNδ	Asn	CG
 	Asn	OD1
 	Asn	ND2
 	Gln	CD
 	Gln	OE1
 	Gln	NE2
RNε	Arg	CD
 	Arg	NE
SOγ	Ser	CB
 	Ser	OG
 	Thr	OG1
 	Tyr	OH
HNε	His	CG
 	His	ND1
 	His	CD2
 	His	CE1
 	His	NE2
 	Trp	NE1
YCξ	Tyr	CE1
 	Tyr	CE2
 	Tyr	CZ
FCξ	Arg	CG
 	Gln	CG
 	Glu	CG
 	Ile	CG1
 	Leu	CG
 	Lys	CG
 	Met	CG
 	Met	SD
 	Phe	CG
 	Phe	CD1
 	Phe	CD2
 	Phe	CE1
 	Phe	CE2
 	Phe	CZ
 	Thr	CG2
 	Trp	CG
 	Trp	CD1
 	Trp	CD2
 	Trp	CE2
 	Trp	CE3
 	Trp	CZ2
 	Trp	CZ3
 	Trp	CH2
 	Tyr	CG
 	Tyr	CD1
 	Tyr	CD2
LCδ	Ile	CG2
 	Ile	CD
 	Leu	CD1
 	Leu	CD2
 	Met	CE
 	Val	CG1
 	Val	CG2
CSγ	Cys	SG

1. Atom types were taken from the work of Zhang et al. [13].
2. BN designate main chain backbone atoms.
3. Atom names are according to the PDB nomenclature.
*/

float const tobi1_one[19][19]={ // Table S2a  (r <= 4)
{ 1.72,	 3.49,	-4.60,	 0.26,	 1.05,	-1.06,	 0.00,	-1.06,	-1.46,	 0.87,	 2.46,	 3.89,	 0.86,	 0.22,	 1.93,	 0.00,	 1.21,	-1.15},
{ 3.49,	 4.96,	 0.86,	-2.58,	 5.42,	 0.61,	 2.05,	 1.96,	 1.02,	 3.61,	-0.53,	 3.77,	 1.30,	 0.99,	-0.85,	 1.72,	 0.92,	 4.18},
{-4.60,	 0.86,	 6.27,	 1.16,	 3.92,	 2.30,	 2.44,	 2.21,	 1.40,	-4.25,	 1.98,	-1.82,	 1.04,	 1.88,	 2.06,	 1.29,	 0.70,	 7.05},
{ 0.26,	-2.58,	 1.16,	 3.42,	-4.88,	-0.17,	-2.39,	-1.94,	 0.82,	 1.63,	-2.09,	-1.73,	-1.46,	-0.40,	-0.99,	 0.66,	-0.59,	 6.48},
{ 1.05,	 5.42,	 3.92,	-4.88,	 0.71,	 2.47,	 4.83,	-0.69,	-0.08,	 5.26,	-1.88,	 4.36,	 1.05,	 2.79,	-3.50,	 0.38,	 1.44,	-0.02},
{-1.06,	 0.61,	 2.30,	-0.17,	 2.47,	 2.23,	-0.46,	 1.44,	 1.20,	 0.59,	 1.02,	 0.97,	 1.78,	 0.89,	-0.12,	-0.31,	 1.59,	-0.26},
{ 0.00,	 2.05,	 2.44,	-2.39,	 4.83,	-0.46,	-3.14,	10.00,	-1.10,	-0.52,	 2.45,	 2.36,	 0.53,	 0.74,	-0.70,	 1.68,	 0.91,	 2.98},
{-1.06,	 1.96,	 2.21,	-1.94,	-0.69,	 1.44,	10.00,	10.00,	 1.72,	-0.71,	-1.80,	 0.15,	 0.44,	-1.31,	 1.42,	-1.01,	-0.60,	 1.55},
{-1.46,	 1.02,	 1.40,	 0.82,	-0.08,	 1.20,	-1.10,	 1.72,	 0.38,	-1.12,	-0.17,	 0.79,	-1.30,	 0.46,	 0.13,	 0.66,	 0.25,	10.00},
{ 0.87,	 3.61,	-4.25,	 1.63,	 5.26,	 0.59,	-0.52,	-0.71,	-1.12,	-0.70,	-0.08,	 3.07,	 1.63,	 0.97,	-1.42,	 1.88,	 0.27,	-2.73},
{ 2.46,	-0.53,	 1.98,	-2.09,	-1.88,	 1.02,	 2.45,	-1.80,	-0.17,	-0.08,	 0.21,	 2.80,	 0.85,	 0.95,	 2.92,	 0.54,	 1.06,	 2.82},
{ 3.89,	 3.77,	-1.82,	-1.73,	 4.36,	 0.97,	 2.36,	 0.15,	 0.79,	 3.07,	 2.80,	 0.94,	-1.49,	-0.62,	 1.64,	-0.56,	 2.37,	 2.07},
{ 0.86,	 1.30,	 1.04,	-1.46,	 1.05,	 1.78,	 0.53,	 0.44,	-1.30,	 1.63,	 0.85,	-1.49,	 2.17,	 1.37,	-0.08,	 0.86,	 0.86,	 5.69},
{ 0.22,	 0.99,	 1.88,	-0.40,	 2.79,	 0.89,	 0.74,	-1.31,	 0.46,	 0.97,	 0.95,	-0.62,	 1.37,	 3.38,	 0.39,	 0.83,	 0.07,	 1.36},
{ 1.93,	-0.85,	 2.06,	-0.99,	-3.50,	-0.12,	-0.70,	 1.42,	 0.13,	-1.42,	 2.92,	 1.64,	-0.08,	 0.39,	 5.24,	 0.45,	 2.27,	 4.27},
{ 0.00,	 1.72,	 1.29,	 0.66,	 0.38,	-0.31,	 1.68,	-1.01,	 0.66,	 1.88,	 0.54,	-0.56,	 0.86,	 0.83,	 0.45,	 1.31,	 0.94,	 2.19},
{ 1.21,	 0.92,	 0.70,	-0.59,	 1.44,	 1.59,	 0.91,	-0.60,	 0.25,	 0.27,	 1.06,	 2.37,	 0.86,	 0.07,	 2.27,	 0.94,	 2.88,	 0.44},
{-1.15,	 4.18,	 7.05,	 6.48,	-0.02,	-0.26,	 2.98,	 1.55,	10.00,	-2.73,	 2.82,	 2.07,	 5.69,	 1.36,	 4.27,	 2.19,	 0.44,	 0.00}};

float const tobi1_two[19][19]={  // Table S2b  (4 < r <= 6)
{ 0.29,	-0.17,	 0.32,	 0.28,	-0.23,	-0.08,	 0.24,	 0.50,	 0.41,	-0.85,	 0.85,	 0.60,	 0.13,	 0.73,	 1.46,	-0.15,	 0.41,	-2.72},
{-0.17,	 0.03,	-0.97,	-0.23,	-1.46,	-0.53,	-0.32,	-0.79,	 0.46,	 1.52,	-0.58,	 0.56,	 0.35,	-0.63,	-2.06,	-0.85,	-1.10,	 1.06},
{ 0.32,	-0.97,	-0.64,	-0.28,	-0.29,	 0.30,	 0.04,	-0.25,	-0.87,	-1.17,	-0.80,	 0.30,	-0.49,	-0.42,	 0.53,	 0.26,	-0.25,	-3.73},
{ 0.28,	-0.23,	-0.28,	 0.87,	 0.50,	 0.40,	 0.38,	 1.29,	-0.10,	-0.20,	-0.05,	-1.54,	-0.81,	 0.27,	-0.32,	-0.24,	 0.43,	 0.45},
{-0.23,	-1.46,	-0.29,	 0.50,	-2.41,	-0.28,	-0.19,	-0.71,	 0.82,	 1.10,	 0.06,	 1.15,	 2.35,	-0.97,	-1.63,	-0.98,	-1.99,	-0.34},
{-0.08,	-0.53,	 0.30,	 0.40,	-0.28,	-0.93,	 0.32,	 1.16,	 0.46,	-0.65,	-0.12,	 0.10,	 0.19,	 0.03,	-0.67,	-0.10,	-0.32,	 0.75},
{ 0.24,	-0.32,	 0.04,	 0.38,	-0.19,	 0.32,	-1.33,	 1.88,	-0.66,	-0.27,	 0.05,	 1.84,	 0.99,	 0.82,	-1.30,	-0.22,	-0.88,	 1.37},
{ 0.50,	-0.79,	-0.25,	 1.29,	-0.71,	 1.16,	 1.88,	-1.81,	-0.97,	-0.42,	-1.00,	 1.66,	-1.20,	-0.49,	 1.32,	-0.46,	 1.50,	-2.08},
{ 0.41,	 0.46,	-0.87,	-0.10,	 0.82,	 0.46,	-0.66,	-0.97,	-0.17,	-0.08,	-0.38,	-0.27,	-0.06,	-0.46,	 0.22,	 0.12,	-0.03,	-1.41},
{-0.85,	 1.52,	-1.17,	-0.20,	 1.10,	-0.65,	-0.27,	-0.42,	-0.08,	 0.43,	-0.20,	-0.05,	-0.43,	 0.37,	-0.45,	 0.12,	-0.05,	 0.30},
{ 0.85,	-0.58,	-0.80,	-0.05,	 0.06,	-0.12,	 0.05,	-1.00,	-0.38,	-0.20,	 0.05,	 0.77,	-0.20,	-0.28,	-0.65,	-0.02,	 0.55,	 0.55},
{ 0.60,	 0.56,	 0.30,	-1.54,	 1.15,	 0.10,	 1.84,	 1.66,	-0.27,	-0.05,	 0.77,	-0.82,	 1.58,	 0.06,	 0.35,	-1.06,	 0.87,	 0.37},
{ 0.13,	 0.35,	-0.49,	-0.81,	 2.35,	 0.19,	 0.99,	-1.20,	-0.06,	-0.43,	-0.20,	 1.58,	 0.16,	-0.48,	 0.12,	-0.52,	-0.07,	-0.17},
{ 0.73,	-0.63,	-0.42,	 0.27,	-0.97,	 0.03,	 0.82,	-0.49,	-0.46,	 0.37,	-0.28,	 0.06,	-0.48,	 1.18,	-0.33,	-0.48,	-0.57,	-1.62},
{ 1.46,	-2.06,	 0.53,	-0.32,	-1.63,	-0.67,	-1.30,	 1.32,	 0.22,	-0.45,	-0.65,	 0.35,	 0.12,	-0.33,	-1.26,	-0.02,	-0.43,	 2.69},
{-0.15,	-0.85,	 0.26,	-0.24,	-0.98,	-0.10,	-0.22,	-0.46,	 0.12,	 0.12,	-0.02,	-1.06,	-0.52,	-0.48,	-0.02,	-0.38,	-0.50,	 0.17},
{ 0.41,	-1.10,	-0.25,	 0.43,	-1.99,	-0.32,	-0.88,	 1.50,	-0.03,	-0.05,	 0.55,	 0.87,	-0.07,	-0.57,	-0.43,	-0.50,	-1.08,	 1.95},
{-2.72,	 1.06,	-3.73,	 0.45,	-0.34,	 0.75,	 1.37,	-2.08,	-1.41,	 0.30,	 0.55,	 0.37,	-0.17,	-1.62,	 2.69,	 0.17,	 1.95,	10.00}};

float const tobi2_one[19][19]={ // Table S3a  (r <= 4)
{-1.02,  1.31,	-2.88,	 0.57,	 5.54,	-0.20,	 0.16,	 1.66,	-1.27,	 0.08,	 0.19,	 3.23,	 1.37,	 0.94,	-0.08,	-0.12,	 0.58,	-2.59,  0.0},
{ 1.31,	 2.97,	 1.67,	-1.70,	 0.91,	 1.04,	 1.70,	 1.66,	 1.22,	 2.50,	-0.54,	 0.55,	 0.60,	-0.23,	-0.68,	 0.56,	 2.10,	 2.73,  0.0},
{-2.88,	 1.67,	 2.97,	 0.41,	 3.28,	 1.19,	 0.69,	 1.15,	 0.14,	-0.44,	 1.53,	 1.04,	 0.22,	 0.60,	 3.51,	 0.86,	 0.26,	 3.90,  0.0},
{ 0.57,	-1.70,	 0.41,	 1.53,	-4.17,	 0.19,	-2.09,	-1.04,	 1.30,	-0.87,	-1.03,	-0.33,	-0.34,	-0.11,	-0.52,	 0.57,	-0.32,	 1.06,  0.0},
{ 5.54,	 0.91,	 3.28,	-4.17,	-5.90,	 1.12,	 4.10,	 4.68,	 0.39,	 1.99,	-0.52,	-1.48,	 1.69,	 0.26,	-2.30,	-0.57,	 1.36,	 0.76,  0.0},
{-0.20,	 1.04,	 1.19,	 0.19,	 1.12,	 1.27,	 0.61,	 0.06,	 0.06,	 0.19,	 0.67,	 1.10,	 0.49,	 0.80,	 0.31,	 0.19,	 0.52,	-0.43,  0.0},
{ 0.16,	 1.70,	 0.69,	-2.09,	 4.10,	 0.61,	 2.63,	 0.67,	-0.68,	 0.21,	 1.77,	 2.75,	 0.30,	 1.22,	-0.01,	 1.45,	 1.26,	 5.73,  0.0},
{ 1.66,	 1.66,	 1.15,	-1.04,	 4.68,	 0.06,	 0.67,	-1.02,	 1.07,	-0.71,	-1.43,	-0.08,	 0.96,	-1.25,	 0.89,	 0.63,	-1.38,	 9.84,  0.0},
{-1.27,	 1.22,	 0.14,	 1.30,	 0.39,	 0.06,	-0.68,	 1.07,	 0.11,	-0.51,	 0.08,	 0.59,	-0.56,	-0.09,	 0.31,	 0.35,	 0.49,	10.00,  0.0},
{ 0.08,	 2.50,	-0.44,	-0.87,	 1.99,	 0.19,	 0.21,	-0.71,	-0.51,	-0.45,	 0.11,	 1.53,	 0.54,	 0.11,	-0.12,	 0.29,	 0.50,	-1.09,  0.0},
{ 0.19,	-0.54,	 1.53,	-1.03,	-0.52,	 0.67,	 1.77,	-1.43,	 0.08,	 0.11,	-0.12,	 2.15,	 0.49,	 0.02,	 0.84,	 0.51,	-0.08,	 0.57,  0.0},
{ 3.23,	 0.55,	 1.04,	-0.33,	-1.48,	 1.10,	 2.75,	-0.08,	 0.59,	 1.53,	 2.15,	-2.54,	-0.05,	 0.32,	 0.33,	-0.13,	 0.82,	 4.87,  0.0},
{ 1.37,	 0.60,	 0.22,	-0.34,	 1.69,	 0.49,	 0.30,	 0.96,	-0.56,	 0.54,	 0.49,	-0.05,	 0.36,	 0.60,	 0.49,	 0.49,	 0.34,	 1.26,  0.0},
{ 0.94,	-0.23,	 0.60,	-0.11,	 0.26,	 0.80,	 1.22,	-1.25,	-0.09,	 0.11,	 0.02,	 0.32,	 0.60,	 1.34,	 0.39,	 1.01,	 0.13,	-0.59,  0.0},
{-0.08,	-0.68,	 3.51,	-0.52,	-2.30,	 0.31,	-0.01,	 0.89,	 0.31,	-0.12,	 0.84,	 0.33,	 0.49,	 0.39,	 3.61,	 0.66,	 2.03,	 2.90,  0.0},
{-0.12,	 0.56,	 0.86,	 0.57,	-0.57,	 0.19,	 1.45,	 0.63,	 0.35,	 0.29,	 0.51,	-0.13,	 0.49,	 1.01,	 0.66,	 0.60,	 0.73,	 2.94,  0.0},
{ 0.58,	 2.10,	 0.26,	-0.32,	 1.36,	 0.52,	 1.26,	-1.38,	 0.49,	 0.50,	-0.08,	 0.82,	 0.34,	 0.13,	 2.03,	 0.73,	 0.74,	-2.03,  0.0},
{-2.59,	 2.73,	 3.90,	 1.06,	 0.76,	-0.43,	 5.73,	 9.84,	10.00,	-1.09,	 0.57,	 4.87,	 1.26,	-0.59,	 2.90,	 2.94,	-2.03,	10.00,  0.0},
{ 0.0,   0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,   0.0}};

float const tobi2_two[19][19]={  // Table S3b  (4 < r <= 6)
{ 0.10,	-0.34,	 0.31,	 0.25,	-0.60,	 0.00,	 0.07,	-0.18,	 0.22,	 0.04,	 0.47,	 0.03,	 0.15,	-0.48,	 0.45,	 0.26,	-0.07,	 0.47,  0.0},
{-0.34,	 0.04,	-0.31,	 0.03,	-0.60,	-0.52,	-0.19,	 0.20,	 0.51,	 0.33,	-0.33,	-0.24,	 0.07,	 0.19,	-1.38,	-0.34,	-0.27,	-0.97,  0.0},
{ 0.31,	-0.31,	-0.16,	-0.39,	 0.68,	 0.07,	 0.19,	 0.30,	-0.48,	-0.38,	-0.28,	 0.08,	-0.22,	-0.28,	 0.39,	-0.29,	 0.02,	-0.64,  0.0},
{ 0.25,	 0.03,	-0.39,	 0.45,	 0.29,	 0.36,	-0.13,	-0.10,	-0.09,	-0.17,	 0.11,	-0.30,	-0.32,	 0.23,	 0.13,	-0.01,	 0.00,	 1.66,  0.0},
{-0.60,	-0.60,	 0.68,	 0.29,	-0.13,	 0.01,	-0.39,	 0.84,	 0.45,	 0.42,	-0.09,	-0.27,	 0.29,	 0.53,	-1.42,	-0.37,	-1.19,	-2.88,  0.0},
{ 0.00,	-0.52,	 0.07,	 0.36,	 0.01,	-0.29,	 0.17,	 1.08,	 0.10,	-0.19,	-0.07,	 0.12,	-0.26,	-0.14,	-0.16,	-0.24,	-0.16,	-0.72,  0.0},
{ 0.07,	-0.19,	 0.19,	-0.13,	-0.39,	 0.17,	-0.91,	 1.23,	-0.43,	 0.52,	-0.23,	 0.72,	 0.66,	 0.56,	-0.49,	-0.05,	-0.12,	-0.13,  0.0},
{-0.18,	 0.20,	 0.30,	-0.10,	 0.84,	 1.08,	 1.23,	 1.05,	-0.23,	-0.43,	-0.55,	 0.46,	-0.48,	-0.57,	-0.57,	-0.35,	-0.93,	 2.73,  0.0},
{ 0.22,	 0.51,	-0.48,	-0.09,	 0.45,	 0.10,	-0.43,	-0.23,	-0.02,	-0.05,	-0.03,	-0.30,	 0.01,	-0.06,	 0.23,	-0.09,	-0.06,	-0.24,  0.0},
{ 0.04,	 0.33,	-0.38,	-0.17,	 0.42,	-0.19,	 0.52,	-0.43,	-0.05,	-0.01,	-0.30,	 0.23,	 0.13,	 0.48,	-0.07,	-0.06,	 0.15,	-0.07,  0.0},
{ 0.47,	-0.33,	-0.28,	 0.11,	-0.09,	-0.07,	-0.23,	-0.55,	-0.03,	-0.30,	-0.05,	 0.16,	-0.09,	 0.24,	-0.21,	-0.03,	 0.41,	-0.04,  0.0},
{ 0.03,	-0.24,	 0.08,	-0.30,	-0.27,	 0.12,	 0.72,	 0.46,	-0.30,	 0.23,	 0.16,	-0.60,	-0.53,	-0.36,	-0.17,	-0.01,	-0.48,	 1.10,  0.0},
{ 0.15,	 0.07,	-0.22,	-0.32,	 0.29,	-0.26,	 0.66,	-0.48,	 0.01,	 0.13,	-0.09,	-0.53,	 0.29,	-0.28,	-0.11,	-0.10,	 0.01,	-0.49,  0.0},
{-0.48,	 0.19,	-0.28,	 0.23,	 0.53,	-0.14,	 0.56,	-0.57,	-0.06,	 0.48,	 0.24,	-0.36,	-0.28,	 0.25,	-0.15,	-0.24,	-0.16,	 1.98,  0.0},
{ 0.45,	-1.38,	 0.39,	 0.13,	-1.42,	-0.16,	-0.49,	-0.57,	 0.23,	-0.07,	-0.21,	-0.17,	-0.11,	-0.15,	-0.49,	-0.15,	-0.19,	 0.52,  0.0},
{ 0.26,	-0.34,	-0.29,	-0.01,	-0.37,	-0.24,	-0.05,	-0.35,	-0.09,	-0.06,	-0.03,	-0.01,	-0.10,	-0.24,	-0.15,	-0.21,	-0.28,	-0.55,  0.0},
{-0.07,	-0.27,	 0.02,	 0.00,	-1.19,	-0.16,	-0.12,	-0.93,	-0.06,	 0.15,	 0.41,	-0.48,	 0.01,	-0.16,	-0.19,	-0.28,	-0.65,	 1.17,  0.0},
{ 0.47,	-0.97,	-0.64,	 1.66,	-2.88,	-0.72,	-0.13,	 2.73,	-0.24,	-0.07,	-0.04,	 1.10,	-0.49,	 1.98,	 0.52,	-0.55,	 1.17,	10.00,  0.0},
{ 0.0,   0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,    0.0,   0.0}};



// TOBI energy calculation "all in one" wrapper.
//  *molR and *molL  --> Receptor and Ligand Macromolecules
//  tobi             --> 1 or 2 for Tobi-1 (ADP-I) or Tobi-2 (ADP-II) energy models (2 by default)
float tobi_energy(Macromolecule *molR, Macromolecule *molL, char tobi = 2);

// TOBI energy calculation.
//  *R/Lcoord    --> Atomic coordinates (R or L stand for either Receptor or Ligand)
//  R/Lnumres    --> Number of residues
//  *R/Lnres     --> Number of atoms for each residue
//  *R/Lpfirst   --> Index of the first atom for each residue
//  *R/Lcas      --> Index of the CA atom for each residue
//  *R/Ltpatom   --> Tobi's atom type
//  tobi         --> 1 or 2 for Tobi-1 (ADP-I) or Tobi-2 (ADP-II) energy models (2 by default)
float tobi_energy(float *Rcoord, int Rnumres, int *Rnres, int *Rpfirst, int *Rcas, int *Rtpatom,
		float *Lcoord, int Lnumres, int *Lnres, int *Lpfirst, int *Lcas, int *Ltpatom, char tobi = 2);

#endif /* INCLUDE_TOBI_H_ */
